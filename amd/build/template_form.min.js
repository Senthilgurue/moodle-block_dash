define(["jquery","jqueryui","core/ajax","block_dash/codemirror","block_dash/codemirror_mode_xml","block_dash/codemirror_mode_handlebars","block_dash/codemirror_mode_sql","block_dash/codemirror_addon_matchbrackets","block_dash/codemirror_addon_show_hint","block_dash/codemirror_addon_sql_hint"],function(a,b,c,d){var e=document.getElementById("id_layout_mustache"),f=document.getElementById("id_query_template");if(e&&d.fromTextArea(e,{lineNumbers:!0,matchBrackets:!0,mode:{name:"handlebars",base:"text/html"}}),f){var g=c.call([{methodname:"block_dash_get_database_schema_structure",args:{}}]);g[0].done(function(a){console.log(JSON.parse(a.schema)),d.fromTextArea(f,{mode:"text/x-mariadb",indentWithTabs:!0,smartIndent:!0,lineNumbers:!0,matchBrackets:!0,autofocus:!0,extraKeys:{"Ctrl-Space":"autocomplete"},hintOptions:{tables:JSON.parse(a.schema)}})})}a("#field_edits tbody").sortable({handle:".drag-handle"}),a("#add-new-field-definition").on("change",function(b){var d=a(this).val();if(d){var e=c.call([{methodname:"block_dash_get_field_edit_row",args:{name:d}}]);e[0].done(function(b){a("#field_edits tbody").append(b.html)})}}),a(".delete-field").on("click",function(b){b.preventDefault(),a(this).closest(".field").remove()})});